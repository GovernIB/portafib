<?xml version="1.0" encoding="UTF-8"?>
<server>
	<mbean code="org.jboss.jms.server.destination.QueueService"
		   name="jboss.messaging.destination:service=Queue,name=jms/es.caib.portafib.PortaFIBNotificacionsErrorQueue"
		   xmbean-dd="xmdesc/Queue-xmbean.xml">
		<depends optional-attribute-name="ServerPeer">jboss.messaging:service=ServerPeer</depends>
		<depends>jboss.messaging:service=PostOffice</depends>
		<attribute name="JNDIName">jms/es.caib.portafib.PortaFIBNotificacionsErrorQueue</attribute>
		<!-- Sempre ha d'anar bé a excepció de quan falla la base de dades -->
		<!-- Per això reintentam cada 5 minuts (300 segons) 2000 vegades = 10.000 minuts = 1 setmana aprox -->
		<attribute name="RedeliveryDelay">300000</attribute>
		<attribute name="MaxDeliveryAttempts">2000</attribute>

	</mbean>
	
	<mbean code="org.jboss.jms.server.destination.QueueService"
		   name="jboss.messaging.destination:service=Queue,name=jms/es.caib.portafib.PortaFIBNotificacionsQueue"
		   xmbean-dd="xmdesc/Queue-xmbean.xml">
		<depends optional-attribute-name="ServerPeer">jboss.messaging:service=ServerPeer</depends>
		<depends>jboss.messaging:service=PostOffice</depends>
		<attribute name="JNDIName">jms/es.caib.portafib.PortaFIBNotificacionsQueue</attribute>
		<attribute name="DLQ">jboss.messaging.destination:service=Queue,name=jms/es.caib.portafib.PortaFIBNotificacionsErrorQueue</attribute>
		<!-- Una vegada acabin els reintents s'haurà de desbloquejar la notificació -->
		<!-- Reintentam cada 2 minuts (120 segons) durant 15 vegades = 30 minuts -->
		<attribute name="RedeliveryDelay">120000</attribute>
		<attribute name="MaxDeliveryAttempts">15</attribute>
	</mbean>
</server>
