
<application-policy name = "seycon">
       <authentication>
	      <login-module code="es.caib.portafib.back.security.BaseCertLoginModule"  flag = "sufficient">		      
		  </login-module>
<!-- SEYCON -->
<!--		  
          <login-module code = "es.caib.loginModule.auth.SeyconEJBLoginModule"
             flag = "sufficient"> 
                <module-option name="unauthenticatedIdentity">nobody</module-option>
                <module-option name="domains">seycon</module-option>
           </login-module>
-->		

<!-- DATABASE -->
          <login-module code="org.jboss.security.auth.spi.DatabaseServerLoginModule" flag="sufficient"> 
            <module-option name="dsJndiName">java:/es.caib.seycon.db.wl</module-option> 
            <module-option name="principalsQuery">
				select USU_PASS from SC_WL_USUARI where USU_CODI = ?
            </module-option> 
            <module-option name="rolesQuery">
				select UGR_CODGRU,'Roles' from SC_WL_USUGRU where UGR_CODUSU = ?
            </module-option> 
          </login-module> 



<!-- LDAP -->
<!--

         <login-module code="org.fundaciobit.plugins.loginmodule.ldap.LdapLoginModule" flag="sufficient" >
			<module-option name="ldap.host_url">ldap://ldap.ibit.org:389</module-option>
			<module-option name="ldap.security_principal">myusername</module-option>
			<module-option name="ldap.security_credentials">mypassword</module-option>
			<module-option name="ldap.security_authentication">simple</module-option>
			<module-option name="ldap.users_context_dn">cn=Users,dc=ibitnet,dc=lan</module-option>
			<module-option name="ldap.search_scope">onelevel</module-option>
			<module-option name="ldap.search_filter">(|(memberOf=CN=@PFI_ADMIN,CN=Users,DC=ibitnet,DC=lan)(memberOf=CN=@PFI_USER,CN=Users,DC=ibitnet,DC=lan))</module-option>
			<module-option name="ldap.prefix_role_match_memberof">CN=@</module-option>
			<module-option name="ldap.suffix_role_match_memberof">,CN=Users,DC=ibitnet,DC=lan</module-option>
			<module-option name="ldap.attribute.username">sAMAccountName</module-option>
			<module-option name="ldap.attribute.mail">mail</module-option>
			<module-option name="ldap.attribute.administration_id">postOfficeBox</module-option>
			<module-option name="ldap.attribute.name">givenName</module-option>
			<module-option name="ldap.attribute.surname">sn</module-option>
			<module-option name="ldap.attribute.telephone">telephoneNumber</module-option>
			<module-option name="ldap.attribute.memberof">memberOf</module-option>
		  </login-module>
-->

                 
           <!--  HTTPS & CLIENTCERT(nomÃ©s per entorns NO CAIB)  -->
	        <login-module code="es.caib.portafib.back.security.BaseCertLoginModule"  flag="sufficient">       
		      </login-module>
  
       </authentication>
    </application-policy>
